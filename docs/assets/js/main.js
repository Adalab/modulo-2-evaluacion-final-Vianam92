"use strict";let dataMovies=[],dataMoviesPrefer=[];const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-btn"),resetElement=document.querySelector(".js-reset"),favoriteElement=document.querySelector(".js-favorite"),resultsElement=document.querySelector(".js-results"),getValueInputHandler=()=>inputElement.value;function getApi(e){e.preventDefault(),fetch(`https://api.jikan.moe/v3/search/anime?q=${inputElement.value}?page=1`).then(e=>{if(!e.ok)throw resultsElement.innerHTML="Not found";return e.json()}).then(e=>{dataMovies=e.results.map(e=>({mal_id:e.mal_id,title:e.title,image_url:e.image_url})),paintMoviesSearch(dataMovies)})}const renderMoviePrefer=e=>{const t=parseInt(e.currentTarget.getAttribute("data-mal_id")),a=e.currentTarget;if(void 0===dataMoviesPrefer.find(e=>e.mal_id===t)){let e=dataMovies.find(e=>e.mal_id===t);dataMoviesPrefer.push({mal_id:e.mal_id,title:e.title,image_url:e.image_url}),a.classList.add("article_results_styles"),a.lastChild.classList.add("article_results_styles--text"),setInLocalStorge()}else{let e=dataMoviesPrefer.findIndex(e=>e.mal_id===t);dataMoviesPrefer.splice(e,1),a.classList.remove("article_results_styles"),a.lastChild.classList.remove("article_results_styles--text"),setInLocalStorge()}paintFavorite(dataMoviesPrefer)},renderRemoveFavoriteMovie=e=>{const t=parseInt(e.currentTarget.dataset.mal_id),a=dataMoviesPrefer.find(e=>e.mal_id===t);dataMoviesPrefer.splice(a,1),paintFavorite(dataMoviesPrefer),paintMoviesSearch(dataMovies),setInLocalStorge()},validarFavoriteInMovieStyles=()=>{dataMoviesPrefer.filter(e=>e.mal_id).forEach(e=>{document.getElementById("res_"+e.mal_id).classList.add("article_results_styles"),document.getElementById("res_"+e.mal_id).lastChild.classList.add("article_results_styles--text")})},getResetHandler=()=>{localStorage.removeItem("data"),dataMoviesPrefer=[];document.getElementById("id").value="",favoriteElement.textContent="",resultsElement.textContent=""},listenEvents=(e,t,a)=>{e.addEventListener(a,t)};listenEvents(btnElement,getApi,"click"),listenEvents(resetElement,getResetHandler,"click");const listenEventFavorite=()=>{const e=document.querySelectorAll(".js-container");for(const t of e)listenEvents(t,renderMoviePrefer,"click")},listenEventRemove=()=>{const e=document.querySelectorAll(".js-remove");for(const t of e)listenEvents(t,renderRemoveFavoriteMovie,"click")},painter=(e,t,a,r,s,l)=>{const i=document.createElement("article");i.className=t,i.id=`${l}_${e.mal_id}`,i.setAttribute("data-mal_id",e.mal_id);const n=document.createElement("img");n.className=a,n.src=""+e.image_url,n.alt=""+e.title;const o=document.createElement("h4");return o.className=r,o.textContent=""+e.title,null===n.src&&(n.src=s),i.appendChild(n),i.appendChild(o),i},paintMoviesSearch=e=>{resultsElement.textContent="";for(const t of e){const e=painter(t,"js-container article_results","article_results--img","article_results--text","https://via.placeholder.com/210x295/ffffff/666666/?text=TV","res");resultsElement.appendChild(e)}listenEventFavorite(),dataMoviesPrefer.filter(e=>e.mal_id).forEach(e=>{document.getElementById("res_"+e.mal_id).classList.add("article_results_styles"),document.getElementById("res_"+e.mal_id).lastChild.classList.add("article_results_styles--text")})},paintFavorite=e=>{favoriteElement.textContent="";for(const t of e){const e=painter(t,"article_favorite article_results_styles","article_favorite--images","article_favorite--text","https://via.placeholder.com/210x295/ffffff/666666/?text=TV","fav"),a=document.createElement("div");a.className="article_favorite_x";const r=document.createElement("p");r.className="article_favorite_x--remove js-remove",r.textContent="x",a.appendChild(r),e.appendChild(a),favoriteElement.appendChild(e)}listenEventRemove()},setInLocalStorge=()=>{const e=JSON.stringify(dataMoviesPrefer);localStorage.setItem("data",e)},getFromLocalStorage=()=>{const e=localStorage.getItem("data");null!==e&&(dataMoviesPrefer=JSON.parse(e)),paintFavorite(dataMoviesPrefer)};getFromLocalStorage();