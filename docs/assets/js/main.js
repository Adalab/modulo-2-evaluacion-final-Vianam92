"use strict";let dataMovies=[],dataMoviesPrefer=[];const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-btn"),resetElement=document.querySelector(".js-reset"),favoriteElement=document.querySelector(".js-favorite"),resultsElement=document.querySelector(".js-results"),getValueInputHandler=()=>inputElement.value,renderMoviePrefer=e=>{const t=parseInt(e.currentTarget.getAttribute("data-mal_id")),a=e.currentTarget;if(void 0===dataMoviesPrefer.find(e=>e.mal_id===t)){let e=dataMovies.find(e=>e.mal_id===t);dataMoviesPrefer.push({mal_id:e.mal_id,title:e.title,image_url:e.image_url}),a.classList.add("article_results--styles"),setInLocalStorge()}else{let e=dataMoviesPrefer.findIndex(e=>e.mal_id===t);dataMoviesPrefer.splice(e,1),a.classList.remove("article_results--styles"),setInLocalStorge()}paintFavorite(dataMoviesPrefer)},renderRemoveFavoriteMovie=e=>{const t=parseInt(e.currentTarget.id),a=dataMoviesPrefer.find(e=>e.mal_id===t);dataMoviesPrefer.splice(a,1),paintFavorite(dataMoviesPrefer),paintMoviesSearch(dataMovies),setInLocalStorge()},removeStyleSearch=e=>dataMoviesPrefer.find(t=>t.mal_id===e.mal_id),validarFavoriteInMovieStyles=()=>{dataMoviesPrefer.filter(e=>e.mal_id).forEach(e=>{document.getElementById("res_"+e.mal_id).classList.add("article_results--styles")})},getResetHandler=()=>{localStorage.removeItem("data"),dataMoviesPrefer=[];document.getElementById("id").value="",favoriteElement.textContent="",resultsElement.textContent=""},listenEvents=(e,t,a)=>{e.addEventListener(a,t)};listenEvents(btnElement,getApi,"click"),listenEvents(resetElement,getResetHandler,"click");const listenEventFavorite=()=>{const e=document.querySelectorAll(".js-container");for(const t of e)listenEvents(t,renderMoviePrefer,"click")},listenEventRemove=()=>{const e=document.querySelectorAll(".js-remove");for(const t of e)listenEvents(t,renderRemoveFavoriteMovie,"click")},divPainter=(e,t,a,r,s)=>{let i="";const l=document.createElement("article");var n;l.className=t,l.id=`${s}_${e.mal_id}`,l.setAttribute("data-mal_id",e.mal_id),n=dataMovies,dataMoviesPrefer.find(e=>e.mal_id===n.mal_id)?(i="article_results--styles",l.classList.add(""+i)):i="";const o=document.createElement("img");return o.placeholder=r,o.className=a,o.src=""+e.image_url,o.alt=""+e.title,l.appendChild(o),l},paintMoviesSearch=e=>{resultsElement.textContent="";for(const t of e){const e=divPainter(t,"js-container article_results","article_results--img","https://via.placeholder.com/210x295/ffffff/666666/?text=TV","res"),a=document.createElement("h4");a.className="article_results--text",a.textContent=""+t.title,e.appendChild(a),resultsElement.appendChild(e)}listenEventFavorite(),dataMoviesPrefer.filter(e=>e.mal_id).forEach(e=>{document.getElementById("res_"+e.mal_id).classList.add("article_results--styles")})},paintFavorite=e=>{favoriteElement.textContent="";for(const t of e){const e=divPainter(t,"article_favorite article_results--styles","article_favorite--images","https://via.placeholder.com/210x295/ffffff/666666/?text=TV","fav"),a=document.createElement("h5");a.className="article_favorite--text",a.textContent=""+t.title;const r=document.createElement("div");r.className="article_favorite_x";const s=document.createElement("p");s.className="article_favorite_x--remove js-remove",s.textContent="x",r.appendChild(s),e.appendChild(a),e.appendChild(r),favoriteElement.appendChild(e)}listenEventRemove()};function getApi(e){e.preventDefault(),fetch("https://api.jikan.moe/v3/search/anime?q="+inputElement.value).then(e=>{if(!e.ok)throw resultsElement.innerHTML="Not found";return e.json()}).then(e=>{dataMovies=e.results,paintMoviesSearch(dataMovies)})}const setInLocalStorge=()=>{const e=JSON.stringify(dataMoviesPrefer);localStorage.setItem("data",e)},getFromLocalStorage=()=>{const e=localStorage.getItem("data");null!==e&&(dataMoviesPrefer=JSON.parse(e)),paintFavorite(dataMoviesPrefer)};getFromLocalStorage();